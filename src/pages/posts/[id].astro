---
import { getCollection, render } from 'astro:content';

import Layout from '@/layouts/Layout.astro';
import TimeHeader from '@/components/posts/TimeHeader.astro';
import PostWrapper from '@/components/posts/PostWrapper.astro';
import WidePostWrapper from '@/components/posts/WidePostWrapper.astro';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map(post => ({
    params: { id: post.id },
    props: { post }
  }));
}
const { post } = Astro.props;
const { Content, headings } = await render(post);
---

<Layout
  metadata={{
    title: post.data.title,
    description: post.data.subtitle,
    image: post.data.excerptImageUrl?.src
  }}
  theme={{
    focus: true
  }}
>
  {
    post.data.postLayout === 'wide' && (
      <WidePostWrapper title={post.data.title} subtitle={post.data.subtitle} {headings} id={post.data.title} image={post.data.excerptImageUrl?.src}>
        <TimeHeader {post} />
        <Content />
      </WidePostWrapper>
    )
  }
  {
    post.data.postLayout === 'std' && (
      <PostWrapper title={post.data.title} subtitle={post.data.subtitle} {headings} id={post.data.title} image={post.data.excerptImageUrl?.src}>
        <TimeHeader {post} />
        <Content />
      </PostWrapper>
    )
  }
</Layout>
