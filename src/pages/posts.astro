---
import { getCollection } from 'astro:content';

import SmallPostPreview from '@/components/posts/SmallPostPreview.astro';
import Layout from '@/layouts/Layout.astro';
import textStyles from '@/styles/text.module.css';
import IconButtonLink from '@/components/IconButtonLink.astro';
const posts = await getCollection('blog');
const sortedPosts = posts.filter(p => p.data.isVisible).sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<Layout metadata={{ title: 'Blog', description: "Sam's blog" }}>
  <main class="min-h-screen pt-16 pb-8">
    <section id="posts" class="container mx-auto flex flex-col items-center justify-center relative">
      <div class="px-4 justify-center flex gap-3 w-full">
        <h2 class={`text-3xl md:text-4xl leading-normal font-semibold text-content ${textStyles.terminal} font-mono`}>ls posts</h2>
      </div>
      <div class="flex absolute gap-3 top-0 w-full justify-end px-4">
        <IconButtonLink
          title="Twitter"
          icon="lucide:twitter"
          url="https://twitter.com/tsuniHD"
          rel="me"
          aria-label="Twitter profile"
        />
        <IconButtonLink
          title="RSS Feed"
          icon="lucide:rss"
          url="/rss.xml"
          rel="alternate"
          type="application/rss+xml"
          aria-label="RSS feed"
        />
        </div>
      <div class="mt-6 grid gap-4 lg:grid-cols-2 xl:grid-cols-3">
        {sortedPosts.map(post => <SmallPostPreview {post} />)}
      </div>
    </section>
  </main>
</Layout>
